@header {import org.StructureGraphic.v1.DSTreeNode;

         import java.awt.*;
         import java.util.Arrays;
         import java.util.List;}

@members {public class Tree implements DSTreeNode {
              private String nodeName;
              private List<Tree> children;

              public Tree(String nodeName, Tree... children) {
                  this.nodeName = nodeName;
                  this.children = Arrays.asList(children);
              }

              public Tree(String nodeName) {
                  this.nodeName = nodeName;
              }

              @Override
              public String toString() {
                  if (children == null) {
                      return nodeName;
                  }

                  StringBuilder builder = new StringBuilder();
                  builder.append("(" + nodeName);

                  for (Tree child : children) {
                      builder.append(" " + child);
                  }
                  builder.append(")");
                  return builder.toString();
              }

              @Override
              public DSTreeNode[] DSgetChildren() {
                  return children != null ? children.toArray(new DSTreeNode[children.size()]) : new DSTreeNode[0];
              }

              @Override
              public Object DSgetValue() {
                  return nodeName;
              }

              @Override
              public Color DSgetColor() {
                  return children == null ? Color.RED : null;
              }

          }
}

boolexp returns [ Tree tree ] : term boolexp_prime;
boolexp_prime returns [ Tree tree ] : OR term boolexp_prime | XOR term boolexp_prime | ;

term returns [ Tree tree ] : factor term_prime {$value = $term_prime.value;} ;
term_prime returns [ Tree tree ] : AND factor term_prime | ;

factor returns [ Tree tree ] :  VAR  | NOT factor |  LEFT_PAREN boolexp RIGHT_PAREN;

VAR : 'a' | 'b' | 'c' | 'd' ;
AND : 'and' ;
OR : 'or' ;
XOR : 'xor' ;
NOT : 'not' ;
LEFT_PAREN : '(';
RIGHT_PAREN : ')';
